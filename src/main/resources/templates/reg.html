<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head >
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>ç¬”è®°ä¸­å¿ƒ</title>
    <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" rel="stylesheet">
    <link href="../static/css/index.css" th:href="@{/css/index.css}" rel="stylesheet">
</head>

<body>
<!-- å¯¼èˆª -->
<nav class="ui inverted segment attached my-padding-tb" >
    <div class="ui container">
        <div class="ui inverted secondary stackable menu">
            <h2 class="ui teal header item">Active Life</h2>
            <div class="ui dropdown item my-mobile-hide  c-item">
                <div class="text  my-font-bigsmall">
                    ğŸ¥‹ç–«æƒ…ç›‘æ§
                </div>
                <div class="menu ">
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="index.html" th:href="@{/}"> å›½å†…ç–«æƒ…</a>
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="world.html" th:href="@{/world}"> å›½å¤–ç–«æƒ…</a>
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="rumor.html" th:href="@{/toRumor(page=1)}"> è­¦è§‰è°£è¨€</a>
                </div>
            </div>
            <div class="ui dropdown item my-mobile-hide  c-item">
                <div class="text  my-font-bigsmall">
                    ğŸ‰ä¸°å¯Œç”Ÿæ´»
                </div>
                <div class="menu ">
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="../login.html"  th:href="@{/life(page=1)}"> å¢åŠ å¨è‰º</a>
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="#" th:href="@{/toyl(page=1)}">æ–°é—»èµ„è®¯</a>
                </div>
            </div>
            <div class="ui dropdown item my-mobile-hide  c-item">
                <div class="text  my-font-bigsmall">
                    ğŸ‘ºé«˜æ•ˆå­¦ä¹ 
                </div>
                <div class="menu ">
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="../login.html" th:href="@{/bj/index}"> åœ¨çº¿ç¬”è®°</a>
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="#" th:href="@{/study}"> åœ¨çº¿å­¦ä¹ </a>
                </div>
            </div>
        </div>
    </div>
    <!-- æ±‰å ¡ -->
    <span class="ui black button my-hanbao my-mobile-show" href="#" id="toggle-menu"><span class="" style="font-size: 30px;">ğŸ”</span></span>
</nav>
<br>
<br><br><br><br><br>

    <!-- ä¸­é—´å†…å®¹ -->
    <div class="my-container centered ">
        <div class="ui container " style="width: 50%">
            <div class="ui middle aligned center aligned grid">
                <div class="column">
                    <h2 class="ui teal image header">
                        <div class="content">
                            ä¸ªäººç¬”è®°æ³¨å†Œ
                        </div>
                    </h2>
                    <form class="ui large form" method="post" th:action="@{/bj/login}">

                        <div class="ui stacked segment">
                            <br>
                            <div class="field">
                                <div class="ui left labeled input">
                                    <label  class="ui green basic label">æ˜µç§°</label>
                                    <input name="nickname" id="nickname" placeholder="nickname" type="text">
                                </div>
                            </div>
                            <div class="field">
                                <div class="ui left labeled input">
                                    <label  class="ui green basic label">æ‰‹æœºå·</label>
                                    <input name="phone" id="phone" placeholder="phone" type="text">
                                </div>
                            </div>
                            <div class="field">
                                <div class="ui left labeled input">
                                    <label  class="ui green basic label">å¯†ç </label>
                                    <input name="password1" id="password1" placeholder="è¯·è¾“å…¥å¯†ç " type="text">
                                </div>
                            </div>
                            <div class="field">
                                <div class="ui left labeled input">
                                    <label  class="ui green basic label">ç¡®è®¤å¯†ç </label>
                                    <input name="password2" id="password2" placeholder="å†æ¬¡è¾“å…¥å¯†ç " type="text">
                                </div>
                            </div>
                            <div class="inline fields">
                                <div class="ten wide field">
                                    <input class="ui input" name="code" id="code" placeholder="éªŒè¯ç " type="text">
                                </div>
                                <div class="six wide field">
                                    <button class="ui  teal button" type="button"  onclick="sendSms(this)">è·å–éªŒè¯ç </button>
                                </div>

                            </div>
                            <button class="ui  teal  button" type="button" onclick="reg()">æ³¨å†Œ</button>
                            <button class="ui  grey  button" onclick="window.history.go(-1)" type="button">è¿”å›</button>
                        </div>

                            <div class="ui error message mini"></div>
                            <div class="ui negative mini message" th:text="${message}" th:unless="${#strings.isEmpty(message)}">
                            </div>
                    </form>


                </div>
            </div>

        </div>
    </div>

<br><br><br><br><br>

    <!-- åº•éƒ¨ -->
    <footer class="ui inverted vertical segment my-padding-shuxian my-margin-top-small "  >
        <div class="ui center aligned container">
            <div class="ui inverted divided grid stackable">
                <div class="four wide  column">
                <div class="ui inverted link list">
                    <div class="item">
                        <img class="ui rounded image" src="../../static/img/wx.jpg" th:src="@{/img/wx.jpg}" style="height: 50% !important;width: 50% !important;">
                    </div>
                </div>
            </div>
                <div class="four wide column">
                    <h4 class="ui inverted header my-opacity-font">å­¦æ ¡</h4>
                    <div class="ui inverted link list">
                        <a class="item" href="">>---è¿åŸå­¦é™¢---<</a>
                        <a class="item" href="">>---æ•°å­¦ä¸ä¿¡æ¯æŠ€æœ¯å­¦é™¢---<</a>
                    </div>
                </div>
                <div class="four wide column">
                    <h4 class="ui inverted header my-opacity-font">è”ç³»æˆ‘</h4>
                    <div class="ui inverted link list">
                        <span class="item" href="">phone:15034344690</span>
                        <span class="item" href="">QQ:905866484</span>
                        <span class="item" href="">email:905866484@qq.com</span>
                    </div>
                </div>
                <div class="four wide column">
                    <h4 class="ui inverted header my-opacity-font">NotForzq</h4>
                    <div class="ui inverted link list">
                        <span class="item">------------------------</span>
                        <span class="item" href="#"> å­¦ä¹ ä¸ä»…ä»…æ˜¯ä¸ºäº†è‡ªå·±ï¼å‰æ–¹ä¸ä¼šå­¤å•ï¼</span>
                        <span class="item">------------------------</span>
                    </div>
                </div>
            </div>
            <div class="ui inverted section divider"></div>
            <p class="item my-opacity-font">Welcome to Active Life, since 2020</p>
            <p class="item my-opacity-font" href="http://www.beian.miit.gov.cn/">æ™‹ICPå¤‡20001376å·-1</p>
        </div>

    </footer>
<script src="http://lib.sinaapp.com/js/jquery/2.0.2/jquery-2.0.2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
<script src="../static/js/layer/layer.js" th:src="@{/js/layer/layer.js}"></script>
<script src="../../static/js/jhbg.js" th:src="@{/js/jhbg.js}"> </script>
<script th:inline="javascript">

        $("#toggle-menu").click(function() {
            $('.c-item').toggleClass('my-mobile-hide');
        });
        $('.ui.dropdown')
            .dropdown({
                on: 'hover'
            });



        var smsButtonflag = true;
        var nickname = document.getElementById("nickname");
        var phone = document.getElementById("phone");
        var password1 = document.getElementById("password1");
        var password2 = document.getElementById("password2");
        var smsCode = document.getElementById("code");
        var realPhone = "";
        var realCode = "";
        function sendSms(span){
            console.log(phone.value)
            if(smsButtonflag){
                var phoneRe = /^1(3[0-9]|47|5[012356789]|66|7[0-9]|8[0-9]|9[89])[0-9]{8}$/g;
                if(!phoneRe.test(phone.value)){
                    layer.msg("æ‰‹æœºå·ç æœ‰è¯¯, è¯·æ£€æŸ¥");
                    return;
                }

                //1.    æ›´æ”¹æŒ‰é’®æ ‡è®°ï¼Œ ä¸å…è®¸å†æ¬¡ç‚¹å‡»
                smsButtonflag = false;
                //2.    æ”¹å˜æ ·å¼
                span.class = "ui grey button disabled";
                layer.msg("è¯·ç­‰å¾…å€’è®¡æ—¶ç»“æŸ ï¼Œå†æ¬¡è·å–");
                var s = 30;

                var iv = setInterval(function(){
                    s--;
                    span.innerHTML = s+"s";
                    if(s == 0){
                        smsButtonflag = true;
                        clearInterval(iv);
                        span.class = "ui teal button";
                        span.title = "ç‚¹å‡»è·å–éªŒè¯ç ";
                        span.innerHTML = "è·å–éªŒè¯ç ";
                    }
                },1000);
                //3.    å‘é€çŸ­ä¿¡
                //3.1   å…ˆè½¬åœˆ

                $.post("/sms","phone="+phone.value,function(data){
                    layer.closeAll();
                    //data: {status:200|-1,msg:"å‘é€æˆåŠŸ|å‘é€å¤±è´¥"}
                    console.log(data.status);
                    layer.msg(data.msg);
                    realPhone = data.realPhone;
                    realCode = data.realCode;
                    console.log(data)

                });
            }
        }

        function reg(){
            var pass1 = password1.value;
            var pass2 = password2.value;
            if(nickname.value == ""){
                layer.msg("è¯·è¾“å…¥æ˜µç§°");return;
            }
            if(phone.value==""){
                layer.msg("è¯·è¾“å…¥æ‰‹æœºå·");return;
            }
            if(pass1 == ""){
                layer.msg("è¯·è¾“å…¥å¯†ç ");return;
            }
            if(pass2 == ""){
                layer.msg("è¯·éªŒè¯å¯†ç ");return;
            }
            if(pass1 != pass2){
                layer.msg("ä¸¤æ¬¡å¯†ç è¾“å…¥ä¸ä¸€è‡´");
                return;
            }
            if(phone.value != realPhone){
                layer.msg("è¯·ä¸è¦å˜æ›´æ‰‹æœºå·");
                return;
            }
            if(smsCode.value == ""){
                layer.msg("è¯·è¾“å…¥éªŒè¯ç ");return;
            }
            if(smsCode.value != realCode){
                layer.msg("éªŒè¯ç è¾“å…¥é”™è¯¯");
                return;
            }
            layer.load();
            $.post("/reg","phone="+phone.value+"&password="+pass1+"&nickname="+nickname.value,function(data){
                layer.closeAll();
                layer.msg(data.msg);
                if(data.status==200){
                    layer.msg("é¡µé¢å³å°†è·³è½¬åˆ°ç™»å½•");
                    setTimeout(function(){
                        window.location.href="/bj";
                    },1000);
                }

            });
        }
    </script>
</body>

</html>