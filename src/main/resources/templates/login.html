<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head >
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>ç¬”è®°ä¸­å¿ƒ</title>
    <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" rel="stylesheet">
    <link href="../static/css/index.css" th:href="@{/css/index.css}" rel="stylesheet">
    <canvas height="990" id="c_n9" style="position: fixed; top: 0px; left: 0px; z-index: -1; opacity: 0.5;" width="1920"></canvas>
</head>

<body>
<!-- å¯¼èˆª -->
<nav class="ui inverted segment attached my-padding-tb" >
    <div class="ui container">
        <div class="ui inverted secondary stackable menu">
            <h2 class="ui teal header item">Active Life</h2>
            <div class="ui dropdown item my-mobile-hide  c-item">
                <div class="text  my-font-bigsmall">
                    ğŸ¥‹ç–«æƒ…ç›‘æ§
                </div>
                <div class="menu ">
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="index.html" th:href="@{/}"> å›½å†…ç–«æƒ…</a>
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="world.html" th:href="@{/world}"> å›½å¤–ç–«æƒ…</a>
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="rumor.html" th:href="@{/toRumor(page=1)}"> è­¦è§‰è°£è¨€</a>
                </div>
            </div>
            <div class="ui dropdown item my-mobile-hide  c-item">
                <div class="text  my-font-bigsmall">
                    ğŸ‰ä¸°å¯Œç”Ÿæ´»
                </div>
                <div class="menu ">
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="../login.html"  th:href="@{/life(page=1)}"> å¢åŠ å¨è‰º</a>
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="#" th:href="@{/toyl(page=1)}">æ–°é—»èµ„è®¯</a>
                </div>
            </div>
            <div class="ui dropdown item my-mobile-hide  c-item">
                <div class="text  my-font-bigsmall">
                    ğŸ‘ºé«˜æ•ˆå­¦ä¹ 
                </div>
                <div class="menu ">
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="../login.html" th:href="@{/bj/index}"> åœ¨çº¿ç¬”è®°</a>
                    <a class="item my-mobile-hide c-item my-font-bigsmall" href="#" th:href="@{/study}"> åœ¨çº¿å­¦ä¹ </a>
                </div>
            </div>
        </div>
    </div>
    <!-- æ±‰å ¡ -->
    <span class="ui black button my-hanbao my-mobile-show" href="#" id="toggle-menu"><span class="" style="font-size: 30px;">ğŸ”</span></span>
</nav>
<br>
<br><br><br><br><br>

    <!-- ä¸­é—´å†…å®¹ -->
    <div class="my-container centered ">
        <div class="ui container " style="width: 50%">
            <div class="ui middle aligned center aligned grid">
                <div class="column">
                    <h2 class="ui teal image header">
                        <div class="content">
                            ä¸ªäººç¬”è®°ç™»å½•
                        </div>
                    </h2>

                    <form class="ui large form" method="post" th:action="@{/bj/login}">
                        <div class="ui stacked segment">

                            <br>
                            <div class="field">
                                <div class="ui left icon input">
                                    <i class="user icon"></i>
                                    <input name="phone" placeholder="Phone" type="text">
                                </div>
                            </div>
                            <div class="field">
                                <div class="ui left icon input">
                                    <i class="lock icon"></i>
                                    <input name="password" placeholder="Password" type="password">
                                </div>
                            </div>
                            <button class="ui inverted green submit button" type="submit">ç™»å½•</button>
                            <a class="ui inverted blue button" th:href="@{/toReg}">æ³¨å†Œ</a>
                            <div class="ui error message mini"></div>
                        </div>
                    </form>
                    <br>
                    <button class="ui animated button inverted violet face " onclick="face()" >
                        <div class="visible content"> <i class="right arrow icon"></i></div>
                        <div class="hidden  content">
                        äººè„¸ç™»å½•
                        </div>
                    </button>

                    <div class="ui negative mini message" th:text="${message}" th:unless="${#strings.isEmpty(message)}"></div>

                    <div class="ui modal tiny face"  >
                        <i class="close icon"></i>
                        <div class="header">
                            åˆ·è„¸ç™»å½•
                        </div>
                        <div class="image content">
                            <video id="video" width="100%" height="100%" autoplay></video>
                            <canvas hidden="hidden" id="canvas" width="500" height="400"></canvas>
                        </div>
                        <div class="actions">
                            <button class="ui inverted green  button" id="CatchCode">
                                æ£€æµ‹ç™»å½•
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

<br><br><br><br><br>

    <!-- åº•éƒ¨ -->
    <footer class="ui inverted vertical segment my-padding-shuxian my-margin-top-small "  >
        <div class="ui center aligned container">
            <div class="ui inverted divided grid stackable">
                <div class="four wide  column">
                    <div class="ui inverted link list">
                        <div class="item">
                            <img class="ui rounded image" src="../../static/img/wx.jpg" th:src="@{/img/wx.jpg}" style="height: 50% !important;width: 50% !important;">
                        </div>
                    </div>
                </div>
                <div class="four wide column">
                    <h4 class="ui inverted header my-opacity-font">å­¦æ ¡</h4>
                    <div class="ui inverted link list">
                        <a class="item" href="">>---è¿åŸå­¦é™¢---<</a>
                        <a class="item" href="">>---æ•°å­¦ä¸ä¿¡æ¯æŠ€æœ¯å­¦é™¢---<</a>
                    </div>
                </div>
                <div class="four wide column">
                    <h4 class="ui inverted header my-opacity-font">è”ç³»æˆ‘</h4>
                    <div class="ui inverted link list">
                        <span class="item" href="">phone:15034344690</span>
                        <span class="item" href="">QQ:905866484</span>
                        <span class="item" href="">email:905866484@qq.com</span>
                    </div>
                </div>
                <div class="four wide column">
                    <h4 class="ui inverted header my-opacity-font">NotForzq</h4>
                    <div class="ui inverted link list">
                        <span class="item">------------------------</span>
                        <span class="item" href="#"> å­¦ä¹ ä¸ä»…ä»…æ˜¯ä¸ºäº†è‡ªå·±ï¼å‰æ–¹ä¸ä¼šå­¤å•ï¼</span>
                        <span class="item">------------------------</span>
                    </div>
                </div>
            </div>
            <div class="ui inverted section divider"></div>
            <p class="item my-opacity-font">Welcome to Active Life, since 2020</p>
            <p class="item my-opacity-font" href="http://www.beian.miit.gov.cn/">æ™‹ICPå¤‡20001376å·-1</p>
        </div>

    </footer>
<script src="http://lib.sinaapp.com/js/jquery/2.0.2/jquery-2.0.2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
<script src="../static/js/layer/layer.js" th:src="@{/js/layer/layer.js}"></script>
<script src="../static/js/jhbg.js" th:src="@{/js/jhbg.js}"> </script>

    <script th:inline="javascript">

        $("#toggle-menu").click(function() {
            $('.c-item').toggleClass('my-mobile-hide');
        });
        $('.ui.dropdown')
            .dropdown({
                on: 'hover'
            });

        $('.ui.form').form({
            fields: {
                phone: {
                    indentifier: 'phone',
                    rules: [{
                        type: 'empty',
                        prompt: 'è¯·è¾“å…¥æ‰‹æœºå·'
                    }]
                },
                password: {
                    indentifier: 'password',
                    rules: [{
                        type: 'empty',
                        prompt: 'è¯·è¾“å…¥å¯†ç '
                    }]
                }
            }
        })
        function face(){
            $('.ui.modal')
                .modal('show');
            open();
        }
        var video;//è§†é¢‘æµå¯¹è±¡
        var context;//ç»˜åˆ¶å¯¹è±¡
        var canvas;//ç”»å¸ƒå¯¹è±¡

        //æ‹ç…§
        $("#CatchCode").click(function() {
            context.drawImage(video, 0, 0, 330, 250);
            CatchCode();
        });

        //å°†å½“å‰å›¾åƒä¼ è¾“åˆ°åå°
        function CatchCode() {
            layer.load();
            //è·å–å›¾åƒ
            var img = getBase64();
            //Ajaxå°†Base64å­—ç¬¦ä¸²ä¼ è¾“åˆ°åå°å¤„ç†
  /*          $.post("/searchFace","img="+img,function (data) {
                //è¿”å›çš„ç»“æœ
                layer.closeAll();
                console.log(data)
                if(data.status == 200){
                    layer.msg(data.msg);
                    setTimeout(function(){
                        window.location.href="/bj/notes";
                    },1000);
                }else{
                    layer.msg(data.msg);
                }
            })*/


            $.ajax({
                type : "POST",
                async : false,
                url : "/searchFace",
                data : {
                    img : img
                },
                success : function(data) {
                    //è¿”å›çš„ç»“æœ
                     layer.closeAll();
                    console.log(data)
                    if(data.status == 200){
                        layer.msg(data.msg);
                        setTimeout(function(){
                            window.location.href="/bj/notes";
                        },1000);
                    }else{
                        layer.msg(data.msg);

                    }
                }
            });
        };
        //å¼€å¯æ‘„åƒå¤´
        function open() {
            //è·å–æ‘„åƒå¤´å¯¹è±¡
            canvas = document.getElementById("canvas");
            context = canvas.getContext("2d");
            //è·å–è§†é¢‘æµ
            video = document.getElementById("video");
            var videoObj = {
                "video" : true
            }, errBack = function(error) {
                console.log("Video capture error: ", error.code);
            };
            context.drawImage(video, 0, 0, 330, 250);
            //åˆå§‹åŒ–æ‘„åƒå¤´å‚æ•°
            if (navigator.getUserMedia || navigator.webkitGetUserMedia
                || navigator.mozGetUserMedia) {
                navigator.getUserMedia = navigator.getUserMedia
                    || navigator.webkitGetUserMedia
                    || navigator.mozGetUserMedia;
                navigator.getUserMedia(videoObj, function(stream) {
                    video.srcObject = stream;
                    video.play();
                }, errBack);
            }
        }
        //å°†æ‘„åƒå¤´æ‹å–çš„å›¾ç‰‡è½¬æ¢ä¸ºBase64æ ¼å¼å­—ç¬¦ä¸²
        function getBase64() {
            //è·å–å½“å‰å›¾åƒå¹¶è½¬æ¢ä¸ºBase64çš„å­—ç¬¦ä¸²
            var imgSrc = canvas.toDataURL("image/png");
            //æˆªå–å­—ç¬¦ä¸²
            return imgSrc.substring(22);
        };
    </script>
</body>

</html>